{% extends "base.html" %}
{% block title %}Trading Case Study Portfolio · Banu{% endblock %}

{% block content %}

<div class="glass-card">
  <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:16px;flex-wrap:wrap;">
    <div>
      <div class="section-heading">Trading Case Study Portfolio</div>
      <p class="section-sub">
        This portfolio showcases how I approach markets: structured setups, disciplined risk, and post-trade reviews.
        Designed for hiring managers who want to see real decision-making, not only performance screenshots.
      </p>
      <button class="btn-primary" onclick="window.open('https://www.linkedin.com/in/banuwijaya','_blank')">
        Hire me on LinkedIn ↗
      </button>
    </div>

    <div style="min-width:220px;">
      <div class="section-sub">Snapshot</div>
      <div style="display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px;margin-top:8px;font-size:12px;">
        <div>
          <div class="section-sub">Closed trades</div>
          <div style="font-size:18px;font-weight:600;margin-top:2px;">{{ closed_count }}</div>
        </div>
        <div>
          <div class="section-sub">Win rate</div>
          <div style="font-size:18px;font-weight:600;margin-top:2px;">{{ win_rate }}%</div>
        </div>
        <div>
          <div class="section-sub">Average R:R</div>
          <div style="font-size:18px;font-weight:600;margin-top:2px;">{{ avg_r }}</div>
        </div>
      </div>
      <div class="section-sub" style="margin-top:8px;">Discipline score: {{ discipline_score }}%</div>
    </div>
  </div>
</div>

<div class="glass-card" style="margin-top:20px;">
  <div class="section-heading" style="font-size:16px;">Planned setups</div>
  <p class="section-sub">Trades in preparation phase. Thesis and risk defined, execution not started.</p>

  <table>
    <thead>
    <tr>
      <th>Date</th>
      <th>Symbol</th>
      <th>TF</th>
      <th>Dir</th>
      <th>R:R</th>
      <th>Grade</th>
      <th></th>
    </tr>
    </thead>
    <tbody>
    {% if planned %}
      {% for t in planned %}
      <tr>
        <td>{{ t.trade_date }}</td>
        <td>{{ t.symbol }}</td>
        <td>{{ t.timeframe }}</td>
        <td>{{ t.direction }}</td>
        <td>{{ t.rr_ratio if t.rr_ratio is not none else "-" }}</td>
        <td>{{ t.grade or "-" }}</td>
        <td>
          <a href="{{ url_for('trade_detail', trade_id=t.id) }}" class="link-pill-outline" style="padding:3px 10px;font-size:10px;">
            View case
          </a>
        </td>
      </tr>
      {% endfor %}
    {% else %}
      <tr><td colspan="7" style="text-align:center;padding:14px 0;color:var(--text-muted);">No planned setups at the moment.</td></tr>
    {% endif %}
    </tbody>
  </table>
</div>

<div class="glass-card" style="margin-top:16px;">
  <div class="section-heading" style="font-size:16px;">Active trades</div>
  <p class="section-sub">Positions currently managed in the market.</p>

  <table>
    <thead>
    <tr>
      <th>Date</th>
      <th>Symbol</th>
      <th>TF</th>
      <th>Dir</th>
      <th>Status</th>
      <th></th>
    </tr>
    </thead>
    <tbody>
    {% if active %}
      {% for t in active %}
      <tr>
        <td>{{ t.trade_date }}</td>
        <td>{{ t.symbol }}</td>
        <td>{{ t.timeframe }}</td>
        <td>{{ t.direction }}</td>
        <td><span class="badge badge-pending">Active</span></td>
        <td>
          <a href="{{ url_for('trade_detail', trade_id=t.id) }}" class="link-pill-outline" style="padding:3px 10px;font-size:10px;">
            View case
          </a>
        </td>
      </tr>
      {% endfor %}
    {% else %}
      <tr><td colspan="6" style="text-align:center;padding:14px 0;color:var(--text-muted);">No active trades.</td></tr>
    {% endif %}
    </tbody>
  </table>
</div>

<div class="glass-card" style="margin-top:16px;">
  <div class="section-heading" style="font-size:16px;">Closed trades (case studies)</div>
  <p class="section-sub">
    Each row links to a full case study with before/after screenshots and a brief review.
  </p>

  <table>
    <thead>
    <tr>
      <th>Date</th>
      <th>Symbol</th>
      <th>TF</th>
      <th>Dir</th>
      <th>Result</th>
      <th>R</th>
      <th>Grade</th>
      <th></th>
    </tr>
    </thead>
    <tbody>
    {% if closed %}
      {% for t in closed %}
      <tr>
        <td>{{ t.trade_date }}</td>
        <td>{{ t.symbol }}</td>
        <td>{{ t.timeframe }}</td>
        <td>{{ t.direction }}</td>
        <td>
          {% if t.result == "WIN" %}
            <span class="badge badge-win">Win</span>
          {% elif t.result == "LOSE" %}
            <span class="badge badge-lose">Lose</span>
          {% elif t.result == "BE" %}
            <span class="badge badge-pending">BE</span>
          {% else %}
            <span class="badge">N/A</span>
          {% endif %}
        </td>
        <td>{{ t.result_r if t.result_r is not none else "-" }}</td>
        <td>{{ t.grade or "-" }}</td>
        <td>
          <a href="{{ url_for('trade_detail', trade_id=t.id) }}" class="link-pill-outline" style="padding:3px 10px;font-size:10px;">
            View case
          </a>
        </td>
      </tr>
      {% endfor %}
    {% else %}
      <tr><td colspan="8" style="text-align:center;padding:14px 0;color:var(--text-muted);">No closed trades yet.</td></tr>
    {% endif %}
    </tbody>
  </table>
</div>

{% endblock %}
