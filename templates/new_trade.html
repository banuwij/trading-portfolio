{% extends "base.html" %}
{% block title %}New Trade · Banu Trading Portfolio{% endblock %}

{% block content %}

<div class="glass-card">
  <div style="display:flex;justify-content:space-between;align-items:flex-start;gap:16px;flex-wrap:wrap;">
    <div>
      <div class="section-heading">New Trade</div>
      <p class="section-sub">
        Log a new trade with your pre-trade thesis, risk, and screenshots. This
        entry will appear in both the owner dashboard and public case-study view.
      </p>
    </div>
    <a href="{{ url_for('admin_dashboard') }}" class="btn-outline" style="font-size:12px;">
      ← Back to dashboard
    </a>
  </div>
</div>

<div class="glass-card" style="margin-top:18px;">
  <form method="post" enctype="multipart/form-data" class="form-two-column">

    <!-- LEFT COLUMN -->
    <div class="form-column">
      <div class="form-section-title">Core trade data</div>

      <div class="form-row-2">
        <label class="form-field">
          <span class="form-label">Trade Date</span>
          <input type="date" name="trade_date" value="{{ today }}" required>
        </label>

        <label class="form-field">
          <span class="form-label">Status</span>
          <select name="status" required>
            <option value="PLANNED">Planned</option>
            <option value="ACTIVE">Active</option>
            <option value="CLOSED">Closed</option>
          </select>
        </label>
      </div>

      <div class="form-row-2">
        <label class="form-field">
          <span class="form-label">Symbol / Pair</span>
          <input type="text" name="symbol" placeholder="e.g. BTCUSDT, ANTM" required>
        </label>

        <label class="form-field">
          <span class="form-label">Timeframe</span>
          <input type="text" name="timeframe" placeholder="e.g. H1, H4, D1">
        </label>
      </div>

      <div class="form-row-3">
        <label class="form-field">
          <span class="form-label">Direction</span>
          <select name="direction" required>
            <option value="">–</option>
            <option value="BUY">Buy</option>
            <option value="SELL">Sell</option>
          </select>
        </label>

        <label class="form-field">
          <span class="form-label">Entry Price</span>
          <input type="number" step="0.0001" name="entry_price" placeholder="Entry">
        </label>

        <label class="form-field">
          <span class="form-label">Stop Loss</span>
          <input type="number" step="0.0001" name="stop_loss" placeholder="SL">
        </label>
      </div>

      <div class="form-row-3">
        <label class="form-field">
          <span class="form-label">Take Profit</span>
          <input type="number" step="0.0001" name="take_profit" placeholder="TP">
        </label>

        <label class="form-field">
          <span class="form-label">Risk per Trade (%)</span>
          <input type="number" step="0.01" name="risk_percent" placeholder="e.g. 0.5, 1, 2">
        </label>

        <label class="form-field">
          <span class="form-label">Result</span>
          <select name="result">
            <option value="">Pending / N/A</option>
            <option value="WIN">Win</option>
            <option value="LOSE">Lose</option>
            <option value="BE">Break-Even</option>
          </select>
        </label>
      </div>

      <div class="form-row-3">
        <label class="form-field">
          <span class="form-label">Grade</span>
          <select name="grade">
            <option value="">–</option>
            <option value="A">A</option>
            <option value="B">B</option>
            <option value="C">C</option>
            <option value="D">D</option>
          </select>
        </label>

        <label class="form-field">
          <span class="form-label">Strategy / Setup</span>
          <select name="strategy_tag">
            <option value="">–</option>
            <option value="SND">SND</option>
            <option value="MR">MR</option>
            <option value="BO">BO</option>
            <option value="SWING">SWING</option>
            <option value="INTRA">INTRA</option>
          </select>
        </label>

        <label class="form-field">
          <span class="form-label">Market Condition</span>
          <input type="text" name="market_condition" placeholder="e.g. Trend, Range, News">
        </label>
      </div>

      <div class="form-section-title" style="margin-top:18px;">Execution checklist</div>
      <div class="checklist-grid">
        <label class="check-item">
          <input type="checkbox" name="followed_plan">
          <span>Followed plan</span>
        </label>
        <label class="check-item">
          <input type="checkbox" name="no_revenge">
          <span>No revenge trade</span>
        </label>
        <label class="check-item">
          <input type="checkbox" name="no_fomo">
          <span>No FOMO entry</span>
        </label>
        <label class="check-item">
          <input type="checkbox" name="respected_rr">
          <span>Min R:R respected</span>
        </label>
      </div>

      <label class="check-item" style="margin-top:8px;">
        <input type="checkbox" name="featured">
        <span>Mark as featured case study</span>
      </label>
    </div>

    <!-- RIGHT COLUMN -->
    <div class="form-column">
      <div class="form-section-title">Narrative & files</div>

      <label class="form-field">
        <span class="form-label">Public summary (for HR)</span>
        <textarea name="notes_public" rows="6"
                  placeholder="Thesis, execution, outcome, and key takeaways in a professional tone."></textarea>
      </label>

      <label class="form-field">
        <span class="form-label">Private notes (only you)</span>
        <textarea name="notes_private" rows="6"
                  placeholder="Emotions, micro mistakes, alternative scenarios, deeper review."></textarea>
      </label>

      <div class="form-section-title" style="margin-top:12px;">Screenshots</div>

      <label class="form-field">
        <span class="form-label">Screenshot BEFORE (required for case study)</span>
        <input type="file" name="screenshot_before" accept="image/*">
      </label>

      <label class="form-field">
        <span class="form-label">Screenshot AFTER (optional, for outcome)</span>
        <input type="file" name="screenshot_after" accept="image/*">
      </label>

      <button type="submit" class="btn-primary" style="margin-top:18px;width:100%;">
        Save trade
      </button>
    </div>

  </form>
</div>

{% endblock %}
